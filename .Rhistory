library(vroom)
library(tidyverse)
library(tidymodels)
library(vroom)
library(tidytext)
library(jsonlite)
train <- vroom("~/GitHub/Stat 348/WhatsCooking/data/train.json/train.json")
train_features <- trainSet_tidy %>%
group_by(id, cuisine) %>%
summarise(numb_ingre = n(), .groups = "drop")
install.packages("lightgbm")
install.packages("textrecipes")
install.packages("themis")  # optional
library(tidyverse)
library(jsonlite)
library(tidymodels)
library(textrecipes)
library(lightgbm)
trainSet <- fromJSON("~/GitHub/Stat 348/WhatsCooking/data/train.json/train.json")
testSet  <- fromJSON("~/GitHub/Stat 348/WhatsCooking/data/test.json/test.json")
train_df <- trainSet %>%
mutate(text = map_chr(ingredients, ~ paste(.x, collapse = " "))) %>%
select(id, cuisine, text)
test_df <- testSet %>%
mutate(text = map_chr(ingredients, ~ paste(.x, collapse = " "))) %>%
select(id, text)
View(test_df)
prep_rec <- prep(rec)
library(tidyverse)
library(jsonlite)
library(tidymodels)
library(textrecipes)
library(bonsai)       # LightGBM engine for tidymodels
trainSet <- fromJSON("~/GitHub/Stat 348/WhatsCooking/data/train.json/train.json")
testSet  <- fromJSON("~/GitHub/Stat 348/WhatsCooking/data/test.json/test.json")
train_df <- trainSet %>%
mutate(text = map_chr(ingredients, paste, collapse = " ")) %>%
select(id, cuisine, text)
test_df <- testSet %>%
mutate(text = map_chr(ingredients, paste, collapse = " ")) %>%
select(id, text)
recipe_spec <- recipe(cuisine ~ text, data = train_df) %>%
step_tokenize(text) %>%
step_stopwords(text) %>%
step_tokenfilter(text, max_tokens = 5000) %>%
step_tf(text)
lgb_spec <- boost_tree(
trees = 1500,
tree_depth = 10,
learn_rate = 0.05
) %>%
set_engine("lightgbm") %>%
set_mode("classification")
wf <- workflow() %>%
add_model(lgb_spec) %>%
add_recipe(recipe_spec)
lgb_fit <- wf %>% fit(data = train_df)
install.packages("stopwords")
